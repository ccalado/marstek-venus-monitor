<div class="section-caption" style="background: #f8d7da; border-left-color: #dc3545;">
    🚫 <strong>DANGER ZONE:</strong> These commands can reset the device, enable firmware updates, or configure parallel operation. May cause data loss or require physical access to recover.
</div>
<div class="command-grid">
    <button onclick="sendCommand(0x0C, 'System Reset', [0x0A, 0x0B, 0x0C, 0x01])" disabled class="btn-danger cmd-button" data-tooltip="Restart the device immediately" data-requires-connection="true">
        <span class="cmd-button-text">⚠️ System Reset</span>
        <span class="info-icon" onclick="event.stopPropagation(); showCommandInfo('reset')">i</span>
    </button>
    <button onclick="sendCommand(0x1F, 'Upgrade Mode', [0x0A, 0x0B, 0x0C])" disabled class="btn-danger cmd-button" data-tooltip="Enter firmware upgrade mode" data-requires-connection="true">
        <span class="cmd-button-text">⚠️ Upgrade Mode</span>
        <span class="info-icon" onclick="event.stopPropagation(); showCommandInfo('upgrade')">i</span>
    </button>
    <button onclick="sendCommand(0x20, 'Parallel Ready', [0x0A, 0x0B, 0x0C, 0x01])" disabled class="btn-danger cmd-button" data-tooltip="Configure for parallel operation" data-requires-connection="true">
        <span class="cmd-button-text">⚠️ Parallel Ready</span>
        <span class="info-icon" onclick="event.stopPropagation(); showCommandInfo('parallel')">i</span>
    </button>
    <button onclick="setCurrentDateTime()" disabled class="btn-danger cmd-button" data-tooltip="Set device clock to current browser time (may affect counters and logging)" data-requires-connection="true">
        <span class="cmd-button-text">🕐 Set Device Time</span>
        <span class="info-icon" onclick="event.stopPropagation(); showCommandInfo('setdevicetime')">i</span>
    </button>
    <button onclick="sendCommand(0x06, 'Factory Reset (WiFi)', [0x01])" disabled class="btn-danger cmd-button" data-tooltip="Factory reset WiFi settings only" data-requires-connection="true">
        <span class="cmd-button-text">🏭 Factory Reset WiFi</span>
        <span class="info-icon" onclick="event.stopPropagation(); showCommandInfo('factoryreset1')">i</span>
    </button>
    <button onclick="sendCommand(0x06, 'Factory Reset (Full)', [0x02])" disabled class="btn-danger cmd-button" data-tooltip="Complete factory reset - all settings" data-requires-connection="true">
        <span class="cmd-button-text">🏭 Factory Reset Full</span>
        <span class="info-icon" onclick="event.stopPropagation(); showCommandInfo('factoryreset2')">i</span>
    </button>
</div>

<!-- Firmware Patch Commands Section -->
<div class="section-caption" style="background: #fff3cd; border-left-color: #ff9800; margin-top: 30px;">
    📦 <strong>FIRMWARE PATCH COMMANDS:</strong> Custom commands for patched Build 154 firmware. Test ping first to verify patch is installed.
</div>
<div class="patch-commands-section">
    <div class="warning-badge">
        ⚠️ Build 154 patched firmware only - Experimental features
    </div>

    <div class="command-grid">
        <button onclick="sendPatchPing()" disabled class="btn-patch cmd-button" data-tooltip="Verify firmware patch is installed" data-requires-connection="true">
            <span class="cmd-button-text">🔍 Ping Patch</span>
            <span class="btn-description">Check patch version</span>
        </button>

        <button onclick="sendPatchReset()" disabled class="btn-patch btn-warning cmd-button" data-tooltip="Reset stored date and energy counters to fix rollover bug" data-requires-connection="true">
            <span class="cmd-button-text">🔄 Reset Counters</span>
            <span class="btn-description">Fix rollover bug</span>
        </button>
    </div>

    <div id="patchStatus" class="patch-status hidden">
        <!-- Patch command status will be displayed here -->
    </div>
</div>

<!-- Hex Data Parser Section -->
<div class="section-caption" style="background: #d1ecf1; border-left-color: #17a2b8; margin-top: 30px;">
    🔍 <strong>HEX DATA PARSER:</strong> Parse and display hex data as if it were received from the device. Useful for debugging and testing.
</div>
<div class="hex-parser-section">
    <div class="hex-parser-input">
        <label for="hexInput">Paste hex data (e.g., from logs):</label>
        <textarea id="hexInput" placeholder="Paste hex data in any format:&#10;&#10;Raw: 73 55 23 14 d7 00 3b 02 e8 03...&#10;&#10;Or full log output:&#10;[21:11:55] Received Command 0x14 (85 bytes):&#10;  0000: 73 55 23 14 d7 00 3b 02  e8 03 e8 03 0c 00 63 00  |sU#...;.......c.|&#10;  0010: 00 14 21 14 00 00 14 00  c0 00 3d 00 00 00 00 00  |..!.......=.....|" rows="8"></textarea>
    </div>
    <div class="hex-parser-buttons">
        <button onclick="parseHexData()" class="btn-primary">📊 Parse Data</button>
        <button onclick="clearHexParser()" class="btn-secondary">🗑️ Clear</button>
    </div>
    <div id="hexParserOutput" class="hex-parser-output hidden">
        <!-- Parsed output will be displayed here -->
    </div>
</div>